{% extends 'base.html' %}
{% block content %}
    <h1>Bunky</h1>

    <h3>Enter an artist and city</h3>
    <form> 
        Artist <input type="text" name="artist" id="artist">
        <p></p>
        City<input type="text" name="city" id="city">
        <p></p>
        <input type="submit" value="Search" id="search-shows">
    </form>

    <p></p>

    <div id="show-results">
        <div><img src="" id="searched-artist-img"></div>
        <p></p>
        <p></p>
        <span style="font-weight: bold" id="searched-artist"></span>
        <p></p>
        <p></p>
        <div id="event-results"></div>
    </div>

    <h3>My Saved Shows</h3>

    <p></p>
    <p></p>

<script src="http://code.jquery.com/jquery.js"></script>

<script>

function showEvents(result) {
 
    $("#searched-artist-img").attr("src", result.searched_artist_img).attr("height", 500);
    $("#searched-artist").text("Shows for artists related to "+result.artist); 

    for (var key in result.events) {

        console.log(result.events[key]['event']); 

        if ((result.events[key]['event']) != null) {

            var event_name = result.events[key]['event']['event_name'];
            var event_city = result.events[key]['event']['city'];
            var songkick_link = result.events[key]['event']['songkick_link'];

            var events = [event_name, event_city, songkick_link]

            $("#event-results").append("<p id='eventname'>"+events[0]+"</p>");
            $("#event-results").append("<p>"+events[1]+"</p>");
            $("#event-results").append("<a href="+events[2]+">Buy Tickets</a>");
            $("#event-results").append("<p>---------------------------------------------------</p>");

        }


        }


    }; 



function findEvents(evt) {

    evt.preventDefault(); 

    var userInputs = {

        artist: $("#artist").val(), 
        city: $("#city").val()


    };

    $.get("/search-for-shows.json", 
        userInputs, 
        showEvents);

};

$('#search-shows').click(findEvents);

</script>



{% endblock %}